knitr::opts_chunk$set(echo = TRUE)
library("ggmosaic")
library("ggplot2")
library("fitdistrplus")
library("MASS")
library("survival")
library("ggstatsplot")
library("tidyverse")
x=read.csv("hotel_bookings.csv", stringsAsFactors = T)
dim(x)
summary(x)
hist(x$adults,breaks=55)
plot(sort(x$adults))
grid()
table(x$adults)
table(x$adults)
x=x[x$adults<10,]
plot(sort(x$adr))
grid()
x=x[x$adr>=0 & x$adr<1000,]
ggplot(data=x, aes(x=adr)) +
geom_histogram(bins=55, colour="black", fill = "lightgray") +
theme_light()
require(fitdistrplus)
descdist(x$adr,boot=1000)
x[is.na(x$children),'children']=0
x=x[x$adr>0 &
(x$stays_in_week_nights+x$stays_in_weekend_nights)>0 &
(x$adults+x$children+x$babies)>0 &
!is.na(x$children),]
# require(ggplot2)
ggplot(data=x, aes(x=adr, fill=hotel)) +
geom_histogram(bins=50, colour="black") +
theme_light()
ggplot(data=x, aes(x=hotel, y=adr, fill=hotel)) +
geom_violin() + geom_boxplot(width=.1, outliers = F) +
coord_flip() +
theme_light()
# require(ggstatsplot)
ggbetweenstats(data=x, x=hotel, y=adr)
# require(tidyverse)
# countries with at least 100 bookings
xx = x %>% group_by(country) %>% mutate(pais=n()) %>% filter(pais>=100)
xx$country=factor(xx$country)
ggplot(data=xx, aes(x=reorder(country, -pais))) +
geom_bar(stat="count", aes(fill=hotel)) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
plot(sort(x$children))
grid()
table(x$children)
x <- x$children <= 3
table(x$children)
x=read.csv("hotel_bookings.csv", stringsAsFactors = T)
dim(x)
x=x[x$adults<10,]
x <- x[x$children <= 3, ]
table(x$children)
plot(sort(x$babies))
grid()
table(x$babies)
x <- x[x$babies <= 2, ]
x <- x[x$babies <= 2, ]
table(x$babies)
plot(sort(x$adr))
grid()
x=x[x$adr>=0 & x$adr<1000,]
x=x[x$adr>=0 & x$adr<1000,]
x=x[x$adr>=0 & x$adr<1000,]
ggplot(data=x, aes(x=adr)) +
geom_histogram(bins=55, colour="black", fill = "lightgray") +
theme_light()
require(fitdistrplus)
descdist(x$adr,boot=1000)
ggplot(data=x, aes(x=adr)) +
geom_histogram(bins=55, colour="black", fill = "lightgray") +
theme_light() +
labs(
title = 'ADR Histogram',
subtitle = 'Count of ADR',
caption = 'Marc Camarillas'
)
ggplot(data=x, aes(x=adr)) +
geom_histogram(bins=55, colour="black", fill = "lightgray") +
theme_light() +
labs(
title = 'ADR Histogram',
subtitle = 'Count of ADR',
caption = 'Autor: Marc Camarillas'
) +
theme(
plot.title = element_text(hjust = 0.5)
)
ggplot(data=x, aes(x=adr)) +
geom_histogram(bins=55, colour="black", fill = "lightgray") +
theme_light() +
labs(
title = 'ADR Histogram',
subtitle = 'Count of ADR',
caption = 'Autor: Marc Camarillas'
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)
)
ggplot(data=x, aes(x=adr)) +
geom_histogram(bins=55, colour="black", fill = "lightgray") +
theme_light() +
labs(
title = 'ADR Histogram',
subtitle = 'Count of ADR',
caption = 'Autor: Marc Camarillas'
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)
)
require(fitdistrplus)
descdist(x$adr,boot=1000)
knitr::opts_chunk$set(echo = TRUE)
library("ggmosaic")
library("ggplot2")
library("fitdistrplus")
library("MASS")
library("survival")
library("ggstatsplot")
library("tidyverse")
x=read.csv("hotel_bookings.csv", stringsAsFactors = T)
dim(x)
summary(x)
hist(x$adults,breaks=55)
plot(sort(x$adults))
grid()
table(x$adults)
x=x[x$adults<10,]
plot(sort(x$children))
grid()
table(x$children)
x <- x[x$children <= 3, ]
plot(sort(x$babies))
grid()
table(x$babies)
x <- x[x$babies <= 2, ]
plot(sort(x$adr))
grid()
x=x[x$adr>=0 & x$adr<1000,]
ggplot(data=x, aes(x=adr)) +
geom_histogram(bins=55, colour="black", fill = "lightgray") +
theme_light() +
labs(
title = 'ADR Histogram',
subtitle = 'Count of ADR',
caption = 'Autor: Marc Camarillas'
) +
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)
)
require(fitdistrplus)
descdist(x$adr,boot=1000)
summary(x$adr)
x <- x[!is.na(x$adr), ]
require(fitdistrplus)
descdist(x$adr,boot=1000)
x[is.na(x$children),'children']=0
x=x[x$adr>0 &
(x$stays_in_week_nights+x$stays_in_weekend_nights)>0 &
(x$adults+x$children+x$babies)>0 &
!is.na(x$children),]
# require(ggplot2)
ggplot(data=x, aes(x=adr, fill=hotel)) +
geom_histogram(bins=50, colour="black") +
theme_light()
ggplot(data=x, aes(x=hotel, y=adr, fill=hotel)) +
geom_violin() + geom_boxplot(width=.1, outliers = F) +
coord_flip() +
theme_light()
# require(ggstatsplot)
ggbetweenstats(data=x, x=hotel, y=adr)
# require(tidyverse)
# countries with at least 100 bookings
xx = x %>% group_by(country) %>% mutate(pais=n()) %>% filter(pais>=100)
xx$country=factor(xx$country)
ggplot(data=xx, aes(x=reorder(country, -pais))) +
geom_bar(stat="count", aes(fill=hotel)) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# require(ggmosaic)
x$is_canceled=as.factor(x$is_canceled)
ggplot(data=x) +
geom_mosaic(aes(x=product(is_canceled, hotel), fill=hotel)) +
theme_light()
# at least 1000 bookings
xx = x %>% group_by(country) %>% mutate(pais=n()) %>% filter(pais>=1000)
xx$country=factor(xx$country)
ggplot(data=xx) +
geom_mosaic(aes(x=product(is_canceled, country), fill=country)) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
ggplot(data = x, aes(x = hotel, fill = factor(is_canceled))) +
geom_bar(position = "stack")
# at least 1000 bookings
xx = x %>% group_by(country) %>% mutate(pais=n()) %>% filter(pais>=1000)
xx$country=factor(xx$country)
ggplot(data=xx) +
geom_mosaic(aes(x=product(is_canceled, country), fill=country)) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
xx
# at least 1000 bookings
xx = x %>% group_by(country) %>% mutate(pais=n()) %>% filter(pais>=1000)
xx
# at least 1000 bookings
xx = x %>% group_by(country) %>% mutate(pais=n()) %>% filter(pais>=1000) %% arrange(desc(pais))
# at least 1000 bookings
xx = x %>% group_by(country) %>% mutate(pais=n()) %>% filter(pais>=1000) %% arrange(desc(pais))
# at least 1000 bookings
xx = x %>% group_by(country) %>% mutate(pais=n()) %>% filter(pais>=1000) %>% arrange(desc(pais))
xx$country=factor(xx$country)
ggplot(data=xx) +
geom_mosaic(aes(x=product(is_canceled, country), fill=country)) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
xx
)
)
# at least 1000 bookings
xx = x %>% group_by(country) %>% mutate(pais=n()) %>% filter(pais>=1000) %>% arrange(desc(pais))
xx$country=factor(xx$country)
ggplot(data=xx) +
geom_mosaic(aes(x=product(is_canceled, country), fill=country)) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# at least 1000 bookings
xx = x %>% group_by(country) %>% mutate(pais=n()) %>% filter(pais>=1000) %>% arrange(desc(pais))
xx$country= factor(xx$country, levels = unique(xx$country))
ggplot(data=xx) +
geom_mosaic(aes(x=product(is_canceled, country), fill=country)) +
theme_light() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# require(lubridate)
x$dia=as_date(paste0(x$arrival_date_year,'-',x$arrival_date_month,'-',x$arrival_date_day_of_month))
ggplot(data=x,aes(x=dia,group=arrival_date_year,color=as.factor(arrival_date_year))) +
geom_bar() + scale_color_manual(values=c("2015"="red","2016"="green","2017"="blue")) +
theme_light() +
theme(legend.position='none')
xx <- x %>% groupby(country) %>% mutate(pais=n()) %>% narrange(desc(pais))
xx <- x %>% groupby(country) %>% mutate(pais=n()) %>% arrange(desc(pais))
xx <- x %>% groupby(country) %>% mutate(pais=n()) %>% filter(pais>=1000) %>% arrange(desc(pais))
max(table(x$dia))
which.max(table(x$dia))
# require(lubridate)
x$tipo=ifelse(x$stays_in_weekend_nights==0, "work",
ifelse(x$stays_in_week_nights==0, "weekend",
ifelse(x$stays_in_week_nights==1 & wday(x$dia)==6, "weekend",
ifelse(x$stays_in_week_nights==5 &
(x$stays_in_weekend_nights==3 |
x$stays_in_weekend_nights==4), "package",
ifelse(x$stays_in_week_nights<=5 &
x$stays_in_weekend_nights<3, "work+rest",
"rest")))))
# require(lubridate)
x$tipo=ifelse(x$stays_in_weekend_nights==0, "work",
ifelse(x$stays_in_week_nights==0, "weekend",
ifelse(x$stays_in_week_nights==1 & wday(x$dia)==6, "weekend",
ifelse(x$stays_in_week_nights==5 &
(x$stays_in_weekend_nights==3 |
x$stays_in_weekend_nights==4), "package",
ifelse(x$stays_in_week_nights<=5 &
x$stays_in_weekend_nights<3, "work+rest",
"rest")))))
# require(lubridate)
x$tipo=ifelse(x$stays_in_weekend_nights==0, "work",
ifelse(x$stays_in_week_nights==0, "weekend",
ifelse(x$stays_in_week_nights==1 & wday(x$dia)==6, "weekend",
ifelse(x$stays_in_week_nights==5 &
(x$stays_in_weekend_nights==3 |
x$stays_in_weekend_nights==4), "package",
ifelse(x$stays_in_week_nights<=5 &
x$stays_in_weekend_nights<3, "work+rest",
"rest")))))
View(x)
View(x)
write.csv(x, './hotel_bookings_clean.csv')
View(x)
View(x)
